<svg xmlns="http://www.w3.org/2000/svg" width="900" height="400" viewBox="0 0 900 400" role="img" aria-label="OpenAI Realtime API architecture diagram">
  <defs>
    <style>
      text { font-family: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace; }
      .label { font-size: 14px; fill: #374151; }
      .title { font-size: 16px; font-weight: 600; fill: #111827; }
      .box { fill: #ffffff; stroke: #e5e7eb; stroke-width: 2; rx: 8; }
      .box-highlight { fill: #f9fafb; stroke: #111827; stroke-width: 2; rx: 8; }
      .arrow { stroke: #6b7280; stroke-width: 2; fill: none; marker-end: url(#arrow); }
      .arrow-media { stroke: #059669; stroke-width: 2.5; fill: none; marker-end: url(#arrow-green); }
      .arrow-events { stroke: #2563eb; stroke-width: 2; stroke-dasharray: 6,4; fill: none; marker-end: url(#arrow-blue); }
      .connector { stroke: #d1d5db; stroke-width: 1.5; fill: none; }
      .note { font-size: 12px; fill: #6b7280; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 Z" fill="#6b7280"/>
    </marker>
    <marker id="arrow-green" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 Z" fill="#059669"/>
    </marker>
    <marker id="arrow-blue" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 Z" fill="#2563eb"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="900" height="400" fill="#fafafa"/>

  <!-- Step 1: Server mints token -->
  <rect class="box" x="40" y="40" width="180" height="100"/>
  <text class="title" x="60" y="70">Your Server</text>
  <text class="label" x="60" y="95">Holds API key</text>
  <text class="label" x="60" y="115">Mints client secrets</text>

  <!-- Step 2: Browser client -->
  <rect class="box-highlight" x="40" y="180" width="180" height="140"/>
  <text class="title" x="60" y="210">Browser Client</text>
  <text class="label" x="60" y="235">RTCPeerConnection</text>
  <text class="label" x="60" y="255">Microphone track</text>
  <text class="label" x="60" y="275">DataChannel</text>
  <text class="note" x="60" y="300">"oai-events"</text>

  <!-- Step 3: OpenAI Realtime -->
  <rect class="box-highlight" x="360" y="100" width="200" height="160"/>
  <text class="title" x="380" y="130">OpenAI Realtime</text>
  <text class="label" x="380" y="160">gpt-realtime model</text>
  <text class="label" x="380" y="180">Session state</text>
  <text class="label" x="380" y="200">VAD / turn detection</text>
  <text class="label" x="380" y="220">Conversation context</text>
  <text class="label" x="380" y="240">Tool execution</text>

  <!-- Legend -->
  <rect class="box" x="680" y="40" width="180" height="120"/>
  <text class="title" x="700" y="65">Legend</text>
  <line x1="700" y1="85" x2="740" y2="85" class="arrow-media"/>
  <text class="label" x="750" y="90">Audio (WebRTC)</text>
  <line x1="700" y1="110" x2="740" y2="110" class="arrow-events"/>
  <text class="label" x="750" y="115">Events (JSON)</text>
  <line x1="700" y1="135" x2="740" y2="135" class="arrow"/>
  <text class="label" x="750" y="140">HTTP</text>

  <!-- Connections -->
  <!-- Server to Browser: client secret -->
  <path class="arrow" d="M130 140 L130 175"/>
  <text class="note" x="140" y="162">client_secret</text>

  <!-- Browser to OpenAI: SDP handshake -->
  <path class="arrow" d="M220 220 L355 180"/>
  <text class="note" x="250" y="185">SDP offer</text>
  
  <path class="arrow" d="M355 195 L220 235"/>
  <text class="note" x="250" y="230">SDP answer</text>

  <!-- Browser to OpenAI: Media -->
  <path class="arrow-media" d="M220 260 L355 200"/>
  <text class="note" x="265" y="255" fill="#059669">mic audio</text>

  <path class="arrow-media" d="M355 210 L220 275"/>
  <text class="note" x="265" y="280" fill="#059669">model audio</text>

  <!-- Browser to OpenAI: Events -->
  <path class="arrow-events" d="M220 295 L355 230"/>
  <text class="note" x="230" y="320" fill="#2563eb">session.update</text>
  <text class="note" x="230" y="335" fill="#2563eb">response.create</text>

  <path class="arrow-events" d="M355 245 L220 310"/>
  <text class="note" x="270" y="305" fill="#2563eb">response.done</text>

  <!-- Server to OpenAI: mint token -->
  <path class="arrow" d="M220 70 L355 140"/>
  <text class="note" x="250" y="90">POST /sessions</text>

  <!-- Sideband connection note -->
  <rect class="box" x="680" y="200" width="180" height="100"/>
  <text class="title" x="700" y="225">Sideband (optional)</text>
  <text class="label" x="700" y="250">Server â†’ same session</text>
  <text class="label" x="700" y="270">via WebSocket</text>
  <text class="note" x="700" y="290">For secure tool handling</text>

  <path class="connector" d="M560 180 L680 240"/>

  <!-- Flow numbers -->
  <circle cx="130" cy="155" r="12" fill="#111827"/>
  <text x="126" y="160" fill="white" font-size="12" font-weight="bold">1</text>

  <circle cx="288" cy="200" r="12" fill="#111827"/>
  <text x="284" y="205" fill="white" font-size="12" font-weight="bold">2</text>

  <circle cx="288" cy="270" r="12" fill="#111827"/>
  <text x="284" y="275" fill="white" font-size="12" font-weight="bold">3</text>

  <!-- Footer -->
  <text x="40" y="380" class="note">1. Server mints ephemeral token   2. WebRTC handshake (SDP exchange)   3. Bidirectional audio + events</text>
</svg>
